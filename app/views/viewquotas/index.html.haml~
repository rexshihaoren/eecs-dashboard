

%h1 #{@user_name}'s Quota

:javascript 
  $(function() {
    var currentquota = [[1246406400000, 1224.3, 27.7],[1246492800000, 143.5, 27.8],[1246579200000, 125.5, 29.6],[1246665600000, 16.7, 30.7],[1246752000000, 11116.5, 25.0],[1246838400000, 17.8, 25.7]]
    var averages = [[1246406400000, 251.5],[1246492800000, 22.1],[1246579200000, 2993],[1246665600000, 223.8],[1246752000000, 21.4],[1246838400000, 21.3]]
    var chart = new Highcharts.Chart({
      chart: {
        renderTo: "view_quota_chart", 
       // type: 'arearange'
      }, 
      title: { 
        text: "Past to Current Quota"
      }, 
      xAxis: {
     	text: "date", 
        type: "datetime",
        dataTimeLabelFormats:{
          day: '%e of %b'
        }
      }, 
      yAxis: {
        type: 'logarithmic',
        title: {
          text: "Bytes", 
          min: 0
        }
      }, 
      series: [{
        name: "Quota", 
        pointInterval: #{1.day * 1000},
        pointStart: #{3.weeks.ago.to_i * 1000},
        data: #{@current_values}
      }
      , 
      {
        name: "Max Quota", 
        data: #{@max_values}, 
        pointInterval: #{1.day * 1000},
        pointStart: #{3.weeks.ago.to_i * 1000}
      }
      ]
    });
    
    //alert(chart.series[1]);
    //series = chart.series[1];
    //series.hide();
  });



%div{:id => "view_quota_chart",  :style => "width:95%; height:50%;"}
 	
%table#viewquota_table
  %head
    %tr{:id => "viewquota_table_header"}
      %td Project Name 
      %td Percent of Quota Used
      %td Change Quota
  %tbody
    - @storage_data.values.each do |storage|
      - storage.each do |proj, percent|
        - if proj == @current_directory
          %tr{:class => 'hilite'}
        - else 
          %tr
          %td= link_to "View #{proj} Quota", viewquotas_path(:current_directory => proj)
          %td= percent
          %td= button_to "Change #{proj} Quota", :action => :change_quota, :modifying_directory => proj, :user => @user_name
          %br/


=link_to "Back to DashBoard", '/dashboard'
          
